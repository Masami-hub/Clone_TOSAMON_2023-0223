<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	
<head>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnEnW16j7tj70" crossorigin="anonymous">
</head>

<body>
<div th:fragment="main">
    <h1>[[ ${title} ]]</h1>    
    <div style="padding-top:163px;"></div> 
    <div class="container text-secondary pb-5">
        <div class="row">
	        <!--左カラム-->
            <div class="col-6">
                <img class="main-img" th:src="@{/images/{image} (image=${item.image})}"></img>
                <div class="d-flex justify-content-between pt-3" style="max-width:450px;">
	           		<!--メイン画像を4枚の小さい画像一番左に表示-->
	           		<img class="sub-img" th:src="@{/images/{image} (image=${item.image})}"></img>
	                <img class="sub-img" th:src="@{/images/{image} (image=${item.img_1})}"></img>
	                <img class="sub-img" th:src="@{/images/{image} (image=${item.img_2})}"></img>
	                <img class="sub-img" th:src="@{/images/{image} (image=${item.img_3})}"></img>
                </div>
            </div>
            
			<!--右カラム-->
            <div class="col-6">
                <h4>[[ ${item.name} ]]</h4>
                <p>[[ ${item.description} ]]</p>
                <div class="d-flex align-items-center">
			    <h3 class="mr-2">[[ ${item.price} ]]円</h3>
			    <!--在庫0になったらSOLDOUT表示させる-->
			    <div th:if="${item.stock == 0}" th:style="${'color: red; font-weight: bold; font-size: x-large;'}" class="ml-4">
			        SOLD OUT
			    </div>
			</div>
                <div class="row d-flex align-items-center ml-1">
	                <!--ハートマーク-->
	                <form method="post" class="like mt-3" th:action="@{/items/toggleLike/{id} (id=${item.id})}">
						<button type="submit" class="like-button">[[ ${item.likedUsers.contains(user) ? '♥' : '♡'} ]]</button>
					</form>
					<!--フキダシ-->
					<div class="baloon mb-2">
						<p>クリックでお気に入りに登録</p>
					</div>
				</div>
        		<!--カートに入れるボタン-->
				<form method="post" th:action="@{/cart/inCart/{itemId}(itemId=${item.id})}" data-toggle="modal" data-target="#cart-in-modal">      
				    <button type="button" class="btn btn-secondary btn-lg btn-block mt-5 mb-4" 
				    		th:classappend="${item.stock == 0} ? 'btn-secondary disabled' : 'btn-warning'"
				    		th:disabled="${item.stock == 0}">
				        この手づくり品を購入する
				    </button>
				    <!--SOLD OUT時のボタンのCSS-->
				    <style>.disabled-btn { background-color: #ccc; color: #fff; }</style>
				</form>
				
				<!--ショップアイコンとショップ名-->
				<div class="d-flex align-items-center">
				    <!--ショップアイコン-->
				    <img class="sub-img rounded-circle mr-2" th:src="@{/images/{image} (image=${shop.shop_icon})}" style="width: 50px; height: 50px;" />
				    <!--ショップ名-->
				    <h5>[[ ${shop.shop_name} ]]</h5>
				</div>
                <!--ショップ紹介文-->
	            <p>[[ ${shop.shop_description} ]]</p>
                
                <!--モーダル-->
                <div class="modal fade" id="cart-in-modal" tabindex="-1" role="dialog" aria-labelledby="cart-in-modal-label" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                        <div class="modal-content">
                            
                            <!--モーダル上段-->
                            <div class="modal-header" style="border-bottom: none;">
                                <button type="submit" class="close" data-dismiss="modal" aria-laber="close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            
                            <!--モーダル中段-->
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-12">
                                        <h5 class="text-center font-weight-bold" id="cart-in-modal-label">この商品をカートに入れますか？</h5>
                                    </div>
                                    <div class="container pt-5">
                                        <div class="row">
                                            <div class="col-3">
                                                <!--商品のアイコン-->
                                                <img th:src="@{/images/{image} (image=${item.image})}" class="img-fluid cart-in-img-trim" style="width: 100px; height:100px;">
                                            </div>
                                            <div class="col-9">
                                                <!--商品名と価格-->
                                                <p>[[ ${item.name} ]]</p>
                                                <p>[[ ${item.price} ]]円</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!--モーダル下段-->
                            <div class="modal-footer my-3 d-flex justify-content-center" style="border-top: none; margin-bottom: 80px;">
								<!--カートに入れるボタン-->
                                <form method="post" th:action="@{/cart/inCart/{itemId}(itemId=${item.id})}">
									<button type="submit" class="btn btn-lg" style="background-color: #e1dccb; color: #000;">カートに入れる</button>
								</form>
							</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
	<!--ショップの場所-->
    <div class="py-5" style="background:#f8f8f4;">
        <div class="container">
            <div class="col-12">
                <h4 class="subheading text-center">ショップの場所</h4>
                <div>
                    <iframe th:src="@{'https://www.google.com/maps/?output=embed&q=' + ${shop.shop_address} + '18&t=m&z=15'}"
                        width="100%"
                        height="400"
                        frameborder="0"
                        style="border:0"
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>
    </div>
	<!--レビュー-->
    <div class="py-5" style="background:#efefeb;">
	    <div class="container">
	        <div class="row justify-content-center">
	            <div class="col-12">
	                <h4 class="subheading text-center">みんなのレビュー</h4>
	            </div>
	            <div th:each="eachReview : ${reviews}" class="review-container d-flex justify-content-center p-3">
				    <div class="review-cell">
				        <div class="row">
				            <div class="col-md-3 border-right">
				                <div class="review-left text-center mt-4 text-muted">
				                    <p class=""><h5>[[ ${eachReview.getUserName} ]] さん</h5></p>
				                    <p class="card-text">[[ ${eachReview.star} ]]</p>
				                </div>
				            </div>
				            <div class="col-md-9">
								<div class="review-right mt-3">
					                <p class="px-2">[[ ${eachReview.comment} ]]</p>
					                <p class="text-right align-bottom text-muted pr-3"><small>[[${#temporals.format(eachReview.createdAt, 'yyyy年M月d日')}]]</small></p>
				                </div>
				            </div>
				        </div>
				    </div>
				</div>
	            <div class="col-12 mt-3">
	                <a th:href="@{/items/detail/{id}/create_review(id=${item.id})}" class="btn-lg justify-content-center d-flex review-post-btn">レビューを投稿する</a>
	            </div>
	        </div>
	    </div>
	</div>
	
	<!--フッター-->
    <footer class="footer justify-content-center d-flex align-items-center">
        <span class="text-muted"><small>&copy;team2</small></span>
    </footer>
</div>
<script src="/src/main/resources/static/JS/script.js"></script>


</body>
</html>